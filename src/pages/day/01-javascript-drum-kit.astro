---
import Layout from '@/layouts/SideBarLayout.astro'
import clap from "@/assets/30days/01-javascript-drum-kit/sounds/clap.wav"
import hihat from "@/assets/30days/01-javascript-drum-kit/sounds/hihat.wav"
import kick from "@/assets/30days/01-javascript-drum-kit/sounds/kick.wav"
import openhat from "@/assets/30days/01-javascript-drum-kit/sounds/openhat.wav"
import boom from "@/assets/30days/01-javascript-drum-kit/sounds/boom.wav"
import ride from "@/assets/30days/01-javascript-drum-kit/sounds/ride.wav"
import snare from "@/assets/30days/01-javascript-drum-kit/sounds/snare.wav"
import tom from "@/assets/30days/01-javascript-drum-kit/sounds/tom.wav"
import tink from "@/assets/30days/01-javascript-drum-kit/sounds/tink.wav"
---
<style>
  .active{
    transform: scale(.95);
    color: white;
    @apply border-primary
  }
</style>
<Layout ActiveLink="01-javascript-drum-kit">
  <h1 class="text-3xl font-bold">Day 01</h1>
   <section class="flex flex-wrap justify-center my-auto caret-transparent transition-all ease 
   duration-75	">
    <div data-key="65" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>A</kbd> 
      <span class="text-primary capitalize text-2xl">clap</span>
    </div>

    <div data-key="83" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>S</kbd>
      <span class="text-primary capitalize text-2xl">hihat</span>
    </div>

    <div data-key="68" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>D</kbd>
      <span class="text-primary capitalize text-2xl">kick</span> 
    </div>

    <div data-key="70" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>F</kbd>
      <span class="text-primary capitalize text-2xl">openhat</span>
    </div>

    <div data-key="71" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>G</kbd>
      <span class="text-primary capitalize text-2xl">boom</span>
    </div>

    <div data-key="72" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>H</kbd>
      <span class="text-primary capitalize text-2xl">ride</span>
    </div>

    <div data-key="74" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>J</kbd>
      <span class="text-primary capitalize text-2xl">snare</span>
    </div>

    <div data-key="75" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>K</kbd>
      <span class="text-primary capitalize text-2xl">tom</span>
    </div>

    <div data-key="76" class="w-40 h-40 bg-base-300 border  border-accent cursor-pointer rounded m-2 flex flex-col items-center justify-center text-5xl text-light hover:scale-105 active:scale-95 transition-all ease-in-out active:text-white active:border-primary">
      <kbd>L</kbd>
      <span class="text-primary capitalize text-2xl">tink</span>
    </div>
  </section>

  <audio data-key="65" src={clap}></audio>
  <audio data-key="83" src={hihat}></audio>
  <audio data-key="68" src={kick}></audio>
  <audio data-key="70" src={openhat}></audio>
  <audio data-key="71" src={boom}></audio>
  <audio data-key="72" src={ride}></audio>
  <audio data-key="74" src={snare}></audio>
  <audio data-key="75" src={tom}></audio>
  <audio data-key="76" src={tink}></audio>

</Layout>

  
<script>

// Function to add the shake effect and yellow border
function shakeKeyboard() {
  const keyboard = document.querySelector('.flex.flex-wrap');
  keyboard?.classList.add('border','shadow-lg', 'rounded', 'border-yellow-500');

  // Shake effect
  setTimeout(() => {
    keyboard.style.transform = 'translateX(-10px)';
  }, 0);
  setTimeout(() => {
    keyboard.style.transform = 'translateX(10px)';
  }, 100);
  setTimeout(() => {
    keyboard.style.transform = 'translateX(-10px)';
  }, 200);
  setTimeout(() => {
    keyboard.style.transform = 'translateX(10px)';
  }, 300);
  setTimeout(() => {
    keyboard.style.transform = 'translateX(0)';
    keyboard?.classList.remove('border','shadow-lg', 'border-yellow-500');
  }, 400);
}

// Get the audio files
function playSound(e) {
  const audio = document.querySelector(`audio[data-key="${e.keyCode}"]`);
    const key = document.querySelector(`div[data-key="${e.keyCode}"]`);

      // Define an array of allowed keyCodes for Tab and Enter
  const allowedKeyCodes = [9, 13];

// Check if the keyCode is not in the allowed range (not Tab or Enter) and if audio is not found
if (!audio && !allowedKeyCodes.includes(e.keyCode)) {
  shakeKeyboard();
  return;
}

    audio.currentTime = 0;
    audio.play();


       // Add the "active" class when a key is pressed
       key.classList.add('active');

}

// Remove the "active" class when the key is released
function removeTransition(e) {
 if (e.propertyName!== 'transform') return;
 e.target.classList.remove('active');
}

// Add a transitionend event to the keys
const keys = document.querySelectorAll('.w-40');
keys.forEach(key => key.addEventListener('transitionend', removeTransition));

// Add onclick listener to play sound

keys.forEach(key => key.addEventListener('click' , (e)=>{
  const datakey = key.getAttribute('data-key');
  const event = {keyCode: datakey};
 playSound(event);
}
));      

// Play the audio when a key is pressed
window.addEventListener('keydown',playSound);
</script>


